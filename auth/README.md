# Сервис авторизации и аутентификации

## Работа с проектом
### Запуск
1. Создать общую сеть
```shell
docker network create etl-network
```
2. Собрать и запустить текущий проект
```shell
docker-compose up --build
```
3. Для создании админа необходимо запустить
```shell
docker exec -it auth-app python manage.py create-admin --login <тут логин> --password <тут пароль> --email <тут почтовый адрес>
```

### Тестирование
Запуск тестов
```shell
docker-compose -f docker-compose.test.yaml up --build --exit-code-from test
```

### Документация
Документация доступна по адресу ``http://127.0.0.1:8001/openapi/docs/``

## Описание проекта
Сервис авторизации представляет собой сервис (API) регистрации и авторизации с системой ролей, написанный на Flask.

### API регистрации и авторизации
- регистрация пользователя;
- вход пользователя в аккаунт (обмен логина и пароля на пару токенов: JWT-access токен и refresh токен); 
- обновление access-токена;
- выход пользователя из аккаунта;
- выход пользователя из всех аккаунтов;
- изменение логина или пароля;
- получение пользователем своей истории входов в аккаунт;

### API для управления доступами
- CRUD для управления ролями:
  - создание роли,
  - удаление роли,
  - изменение роли,
  - просмотр всех ролей.
- назначить пользователю роль;
- отобрать у пользователя роль;
- метод для проверки наличия прав у пользователя. 

### Контроль доступа на основе ролей
- список присвоенных ролей пользователю передается в токене (user_roles в access_claims)
